<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EDUMARK - Admin Panel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Lato', sans-serif; }
        .active { background-color: #dc2626; color: white; } /* red-600 */
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid #dc2626; border-radius: 50%; width: 20px; height: 20px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="bg-gray-100">
    <div id="login-screen" class="flex items-center justify-center h-screen">
        <div class="w-full max-w-md p-8 space-y-8 bg-white rounded-2xl shadow-lg">
            <div class="text-center">
                <img src="https://i.postimg.cc/1RrykwG3/Blue-and-White-Modern-School-Logo.gif" alt="EDUMARK Logo" class="w-24 h-24 mx-auto mb-4">
                <h2 class="text-3xl font-extrabold text-gray-900">EDUMARK Admin Panel</h2>
                <p class="mt-2 text-sm text-gray-600">Please sign in to continue</p>
            </div>
            <form id="login-form" class="mt-8 space-y-6">
                <div><label for="email" class="sr-only">Email address</label><input id="email" name="email" type="email" autocomplete="email" required class="w-full px-4 py-3 text-gray-700 bg-gray-100 border rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500" placeholder="Email address"></div>
                <div><label for="password" class="sr-only">Password</label><input id="password" name="password" type="password" autocomplete="current-password" required class="w-full px-4 py-3 text-gray-700 bg-gray-100 border rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500" placeholder="Password"></div>
                <button type="submit" class="w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors">Sign in</button>
                <p id="login-error" class="text-red-500 text-sm mt-2 text-center"></p>
            </form>
        </div>
    </div>
    <div id="dashboard" class="hidden">
        <header class="bg-white shadow-md">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex items-center justify-between h-16">
                    <div class="flex items-center">
                        <img src="https://i.postimg.cc/1RrykwG3/Blue-and-White-Modern-School-Logo.gif" alt="EDUMARK Logo" class="h-10 w-10">
                        <span class="ml-3 text-2xl font-bold text-gray-800">EDUMARK</span>
                    </div>
                    <button id="logout-button" class="text-sm font-medium text-white bg-red-600 hover:bg-red-700 px-4 py-2 rounded-lg transition-colors">Logout</button>
                </div>
            </div>
        </header>
        <main class="container mx-auto p-4 sm:p-6 lg:p-8">
            <div class="flex flex-col lg:flex-row gap-8">
                <aside class="w-full lg:w-1/4">
                    <div class="bg-white p-4 rounded-xl shadow-lg">
                        <nav class="space-y-2">
                            <button data-tab="students" class="w-full text-left font-semibold p-3 rounded-lg tab-button active">Student Management</button>
                            <button data-tab="results" class="w-full text-left font-semibold p-3 rounded-lg tab-button">Result Management</button>
                            <button data-tab="announcements" class="w-full text-left font-semibold p-3 rounded-lg tab-button">Announcements</button>
                            <button data-tab="settings" class="w-full text-left font-semibold p-3 rounded-lg tab-button">School Settings</button>
                        </nav>
                    </div>
                </aside>
                <div class="w-full lg:w-3/4">
                    <div id="students-tab" class="tab-content bg-white p-6 rounded-xl shadow-lg">
                        <div class="border-b pb-4 mb-6">
                            <h2 id="student-form-title" class="text-2xl font-bold text-gray-800">Add New Student</h2>
                            <p class="text-gray-500">Fill in the details to add or update a student record.</p>
                        </div>
                        <form id="add-student-form" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <input type="hidden" id="student-id">
                            <div><label for="student-name" class="block text-sm font-medium text-gray-700">Student Name</label><input type="text" id="student-name" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-red-500 focus:border-red-500" required></div>
                            <div><label for="father-name" class="block text-sm font-medium text-gray-700">Father's Name</label><input type="text" id="father-name" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-red-500 focus:border-red-500" required></div>
                            <div><label for="roll-number" class="block text-sm font-medium text-gray-700">Roll Number</label><input type="text" id="roll-number" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-red-500 focus:border-red-500" required></div>
                            <div><label for="student-class" class="block text-sm font-medium text-gray-700">Class</label><input type="text" id="student-class" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-red-500 focus:border-red-500" required></div>
                            <div class="md:col-span-2"><label for="student-photo-url" class="block text-sm font-medium text-gray-700">Student Photo URL</label><input type="url" id="student-photo-url" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-red-500 focus:border-red-500" placeholder="https://example.com/image.png"></div>
                            <div class="md:col-span-2 flex items-center gap-4">
                                <button type="submit" id="submit-student-btn" class="inline-flex items-center justify-center py-2 px-6 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 transition-colors">
                                    <span id="submit-student-btn-text">Add Student</span><div id="student-loader" class="loader hidden ml-2"></div>
                                </button>
                                <button type="button" id="cancel-edit-btn" class="hidden py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50">Cancel Edit</button>
                            </div>
                        </form>
                        <div class="mt-10">
                            <h3 class="text-xl font-bold text-gray-800 mb-4">Current Students</h3>
                            <div class="overflow-x-auto border rounded-lg">
                                <table class="w-full min-w-[600px]"><thead class="bg-gray-50"><tr class="text-left text-xs font-semibold text-gray-500 uppercase tracking-wider"><th class="p-3">Photo</th><th class="p-3">Name</th><th class="p-3">Roll No.</th><th class="p-3">Class</th><th class="p-3">Actions</th></tr></thead><tbody id="students-list" class="bg-white divide-y divide-gray-200"></tbody></table>
                            </div>
                        </div>
                    </div>
                    <div id="results-tab" class="tab-content hidden bg-white p-6 rounded-xl shadow-lg">
                        <div class="border-b pb-4 mb-6"><h2 class="text-2xl font-bold text-gray-800">Upload Results</h2><p class="text-gray-500">Select a student and enter their marks for each subject.</p></div>
                        <form id="result-form" class="space-y-6">
                            <div><label for="result-student-select" class="block text-sm font-medium text-gray-700">Select Student</label><select id="result-student-select" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-red-500 focus:border-red-500" required><option value="">-- Select Student --</option></select></div>
                            <div id="subjects-container" class="space-y-4"></div>
                            <div class="flex items-center gap-4">
                                <button type="button" id="add-subject-btn" class="py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50">Add Subject</button>
                                <button type="submit" class="inline-flex items-center justify-center py-2 px-6 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 transition-colors"><span id="submit-result-btn-text">Upload Result</span><div id="result-loader" class="loader hidden ml-2"></div></button>
                            </div>
                        </form>
                    </div>
                    <div id="announcements-tab" class="tab-content hidden bg-white p-6 rounded-xl shadow-lg">
                        <div class="border-b pb-4 mb-6"><h2 class="text-2xl font-bold text-gray-800">Manage Announcements</h2><p class="text-gray-500">Create or delete school-wide announcements.</p></div>
                        <form id="announcement-form" class="space-y-4">
                            <div><label for="announcement-title" class="block text-sm font-medium text-gray-700">Title</label><input type="text" id="announcement-title" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-red-500 focus:border-red-500" required></div>
                            <div><label for="announcement-content" class="block text-sm font-medium text-gray-700">Content</label><textarea id="announcement-content" rows="4" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-red-500 focus:border-red-500" required></textarea></div>
                            <button type="submit" class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 transition-colors">Post Announcement</button>
                        </form>
                        <div class="mt-10"><h3 class="text-xl font-bold text-gray-800 mb-4">Posted Announcements</h3><div id="announcements-list-admin" class="space-y-4"></div></div>
                    </div>
                    <div id="settings-tab" class="tab-content hidden bg-white p-6 rounded-xl shadow-lg">
                        <div class="border-b pb-4 mb-6"><h2 class="text-2xl font-bold text-gray-800">School Settings</h2><p class="text-gray-500">Manage general school information and branding.</p></div>
                        <form id="settings-form" class="space-y-4 max-w-lg">
                            <div><label for="school-name-setting" class="block text-sm font-medium text-gray-700">School Name</label><input type="text" id="school-name-setting" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-red-500 focus:border-red-500"></div>
                            <div><label for="school-logo-url" class="block text-sm font-medium text-gray-700">School Logo URL</label><input type="url" id="school-logo-url" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-red-500 focus:border-red-500" placeholder="https://example.com/logo.png"></div>
                            <div><label for="teacher-signature-url" class="block text-sm font-medium text-gray-700">Class Teacher's Signature URL</label><input type="url" id="teacher-signature-url" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-red-500 focus:border-red-500" placeholder="https://example.com/teacher_sig.png"></div>
                            <div><label for="principal-signature-url" class="block text-sm font-medium text-gray-700">Principal's Signature URL</label><input type="url" id="principal-signature-url" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-red-500 focus:border-red-500" placeholder="https://example.com/principal_sig.png"></div>
                            <div class="flex items-center gap-4">
                                <button type="submit" id="save-settings-btn" class="inline-flex justify-center items-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 transition-colors"><span id="save-settings-btn-text">Save Settings</span><div id="settings-loader" class="loader hidden ml-2"></div></button>
                            </div>
                            <p id="settings-status" class="text-sm mt-2"></p>
                        </form>
                    </div>
                </div>
            </div>
        </main>
    </div>
    <div id="confirmation-modal" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full flex items-center justify-center z-50 p-4">
        <div class="bg-white p-8 rounded-lg shadow-xl w-full max-w-md"><h2 id="modal-title" class="text-xl font-bold mb-4">Confirm Action</h2><p id="modal-text" class="mb-6"></p><div class="flex justify-end gap-4"><button id="modal-cancel-btn" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded">Cancel</button><button id="modal-confirm-btn" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded">Confirm</button></div></div>
    </div>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
        import { getFirestore, collection, doc, addDoc, onSnapshot, query, updateDoc, deleteDoc, getDoc, setDoc, orderBy } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
        const firebaseConfig = { apiKey: "AIzaSyDX4QZxAoYg3lKQ_FWFUNyW0fsN3o0LGRQ", authDomain: "result-fe1c5.firebaseapp.com", projectId: "result-fe1c5", storageBucket: "result-fe1c5.firebasestorage.app", messagingSenderId: "690264860647", appId: "1:690264860647:web:b3dde57cdc117df4367f42" };
        const app = initializeApp(firebaseConfig), auth = getAuth(app), db = getFirestore(app);
        const elements = { loginScreen: document.getElementById('login-screen'), dashboard: document.getElementById('dashboard'), loginForm: document.getElementById('login-form'), loginError: document.getElementById('login-error'), logoutButton: document.getElementById('logout-button'), studentsList: document.getElementById('students-list'), addStudentForm: document.getElementById('add-student-form'), studentIdInput: document.getElementById('student-id'), studentFormTitle: document.getElementById('student-form-title'), submitStudentBtn: document.getElementById('submit-student-btn'), submitStudentBtnText: document.getElementById('submit-student-btn-text'), studentLoader: document.getElementById('student-loader'), cancelEditBtn: document.getElementById('cancel-edit-btn'), resultStudentSelect: document.getElementById('result-student-select'), resultForm: document.getElementById('result-form'), subjectsContainer: document.getElementById('subjects-container'), addSubjectBtn: document.getElementById('add-subject-btn'), resultLoader: document.getElementById('result-loader'), announcementForm: document.getElementById('announcement-form'), announcementsListAdmin: document.getElementById('announcements-list-admin'), confirmationModal: document.getElementById('confirmation-modal'), modalTitle: document.getElementById('modal-title'), modalText: document.getElementById('modal-text'), modalConfirmBtn: document.getElementById('modal-confirm-btn'), modalCancelBtn: document.getElementById('modal-cancel-btn'), settingsForm: document.getElementById('settings-form'), settingsStatus: document.getElementById('settings-status'), saveSettingsBtn: document.getElementById('save-settings-btn'), settingsLoader: document.getElementById('settings-loader') };
        let isEditMode = false, studentsData = [], actionToConfirm = null;
        function showConfirmationModal(title, text, onConfirm) { elements.modalTitle.textContent = title; elements.modalText.textContent = text; actionToConfirm = onConfirm; elements.confirmationModal.classList.remove('hidden'); }
        function hideConfirmationModal() { elements.confirmationModal.classList.add('hidden'); actionToConfirm = null; }
        function resetStudentForm() { isEditMode = false; elements.addStudentForm.reset(); elements.studentIdInput.value = ''; elements.studentFormTitle.textContent = 'Add New Student'; elements.submitStudentBtnText.textContent = 'Add Student'; elements.cancelEditBtn.classList.add('hidden'); }
        function loadStudents() { onSnapshot(query(collection(db, "students"), orderBy("name")), (snapshot) => { elements.studentsList.innerHTML = ''; elements.resultStudentSelect.innerHTML = '<option value="">-- Select Student --</option>'; studentsData = []; snapshot.forEach(doc => { const student = { id: doc.id, ...doc.data() }; studentsData.push(student); const tr = document.createElement('tr'); const photoUrl = student.photoUrl || 'https://placehold.co/60x60/e2e8f0/e2e8f0?text='; tr.innerHTML = `<td class="p-3"><img src="${photoUrl}" alt="${student.name}" class="w-10 h-10 rounded-full object-cover"></td><td class="p-3 font-medium text-gray-900">${student.name}</td><td class="p-3 text-gray-500">${student.rollNumber}</td><td class="p-3 text-gray-500">${student.class}</td><td class="p-3 space-x-3"><button class="text-blue-500 hover:underline edit-student" data-id="${doc.id}">Edit</button><button class="text-red-500 hover:underline delete-student" data-id="${doc.id}">Delete</button></td>`; elements.studentsList.appendChild(tr); const option = document.createElement('option'); option.value = doc.id; option.textContent = `${student.name} (Roll: ${student.rollNumber})`; elements.resultStudentSelect.appendChild(option); }); }); }
        function loadAnnouncements() { onSnapshot(query(collection(db, "announcements"), orderBy("createdAt", "desc")), snapshot => { elements.announcementsListAdmin.innerHTML = ''; snapshot.forEach(doc => { const ann = doc.data(); const div = document.createElement('div'); div.className = 'p-4 border rounded-lg flex justify-between items-start'; const date = ann.createdAt.toDate().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }); div.innerHTML = `<div><h4 class="font-bold text-gray-800">${ann.title}</h4><p class="text-gray-600 mt-1">${ann.content}</p><p class="text-xs text-gray-400 mt-2">${date}</p></div><button class="text-red-500 hover:underline delete-announcement-btn" data-id="${doc.id}">Delete</button>`; elements.announcementsListAdmin.appendChild(div); }); }); }
        async function loadSettings() { const docSnap = await getDoc(doc(db, "settings", "schoolDetails")); if (docSnap.exists()) { const data = docSnap.data(); document.getElementById('school-name-setting').value = data.name || 'EDUMARK'; document.getElementById('school-logo-url').value = data.logoUrl || 'https://i.postimg.cc/1RrykwG3/Blue-and-White-Modern-School-Logo.gif'; document.getElementById('teacher-signature-url').value = data.teacherSignatureUrl || ''; document.getElementById('principal-signature-url').value = data.principalSignatureUrl || ''; } else { document.getElementById('school-name-setting').value = 'EDUMARK'; document.getElementById('school-logo-url').value = 'https://i.postimg.cc/1RrykwG3/Blue-and-White-Modern-School-Logo.gif'; } }
        onAuthStateChanged(auth, user => { if (user) { elements.loginScreen.classList.add('hidden'); elements.dashboard.classList.remove('hidden'); loadStudents(); loadAnnouncements(); loadSettings(); } else { elements.loginScreen.classList.remove('hidden'); elements.dashboard.classList.add('hidden'); } });
        elements.loginForm.addEventListener('submit', (e) => { e.preventDefault(); signInWithEmailAndPassword(auth, document.getElementById('email').value, document.getElementById('password').value).catch(error => elements.loginError.textContent = error.message); });
        elements.logoutButton.addEventListener('click', () => signOut(auth));
        elements.modalCancelBtn.addEventListener('click', hideConfirmationModal);
        elements.modalConfirmBtn.addEventListener('click', async () => { if (actionToConfirm) await actionToConfirm(); hideConfirmationModal(); });
        document.querySelectorAll('.tab-button').forEach(button => button.addEventListener('click', () => { document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active')); button.classList.add('active'); document.querySelectorAll('.tab-content').forEach(content => content.classList.add('hidden')); document.getElementById(`${button.dataset.tab}-tab`).classList.remove('hidden'); }));
        elements.addStudentForm.addEventListener('submit', async (e) => { e.preventDefault(); const studentData = { name: document.getElementById('student-name').value, fatherName: document.getElementById('father-name').value, rollNumber: document.getElementById('roll-number').value, class: document.getElementById('student-class').value, photoUrl: document.getElementById('student-photo-url').value || null }; elements.submitStudentBtn.disabled = true; elements.studentLoader.classList.remove('hidden'); try { if (isEditMode) await updateDoc(doc(db, "students", elements.studentIdInput.value), studentData); else await addDoc(collection(db, "students"), studentData); resetStudentForm(); } catch (error) { console.error(error); } finally { elements.submitStudentBtn.disabled = false; elements.studentLoader.classList.add('hidden'); } });
        elements.studentsList.addEventListener('click', e => { const target = e.target; if (target.classList.contains('edit-student')) { const student = studentsData.find(s => s.id === target.dataset.id); if (student) { document.getElementById('student-name').value = student.name; document.getElementById('father-name').value = student.fatherName || ''; document.getElementById('roll-number').value = student.rollNumber; document.getElementById('student-class').value = student.class; document.getElementById('student-photo-url').value = student.photoUrl || ''; elements.studentIdInput.value = student.id; isEditMode = true; elements.studentFormTitle.textContent = 'Edit Student'; elements.submitStudentBtnText.textContent = 'Update Student'; elements.cancelEditBtn.classList.remove('hidden'); window.scrollTo(0, 0); } } if (target.classList.contains('delete-student')) { showConfirmationModal('Confirm Deletion', 'Are you sure you want to delete this student and their result?', async () => { await deleteDoc(doc(db, "students", target.dataset.id)); await deleteDoc(doc(db, "results", target.dataset.id)); }); } });
        elements.cancelEditBtn.addEventListener('click', resetStudentForm);
        elements.addSubjectBtn.addEventListener('click', () => { const subjectDiv = document.createElement('div'); subjectDiv.className = 'grid grid-cols-1 sm:grid-cols-3 gap-4 items-center'; subjectDiv.innerHTML = `<input type="text" placeholder="Subject Name" class="subject-name sm:col-span-1 mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm" required><input type="number" placeholder="Total Marks" class="total-marks sm:col-span-1 mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm" required><input type="number" placeholder="Obtained Marks" class="obtained-marks sm:col-span-1 mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm" required>`; elements.subjectsContainer.appendChild(subjectDiv); });
        elements.resultForm.addEventListener('submit', async (e) => { e.preventDefault(); const studentId = elements.resultStudentSelect.value; if (!studentId) return; const subjects = []; document.querySelectorAll('#subjects-container > div').forEach(div => { subjects.push({ name: div.querySelector('.subject-name').value, total: div.querySelector('.total-marks').value, obtained: div.querySelector('.obtained-marks').value }); }); elements.resultLoader.classList.remove('hidden'); try { await setDoc(doc(db, "results", studentId), { subjects }); elements.resultForm.reset(); elements.subjectsContainer.innerHTML = ''; } catch (error) { console.error(error); } finally { elements.resultLoader.classList.add('hidden'); } });
        elements.announcementForm.addEventListener('submit', async (e) => { e.preventDefault(); await addDoc(collection(db, "announcements"), { title: document.getElementById('announcement-title').value, content: document.getElementById('announcement-content').value, createdAt: new Date() }); elements.announcementForm.reset(); });
        elements.announcementsListAdmin.addEventListener('click', e => { if (e.target.classList.contains('delete-announcement-btn')) { showConfirmationModal('Confirm Deletion', 'Are you sure you want to delete this announcement?', () => deleteDoc(doc(db, "announcements", e.target.dataset.id))); } });
        elements.settingsForm.addEventListener('submit', async (e) => { e.preventDefault(); const { settingsStatus, saveSettingsBtn, settingsLoader } = elements; settingsStatus.textContent = 'Saving...'; settingsStatus.style.color = 'gray'; saveSettingsBtn.disabled = true; settingsLoader.classList.remove('hidden'); const settingsData = { name: document.getElementById('school-name-setting').value, logoUrl: document.getElementById('school-logo-url').value, teacherSignatureUrl: document.getElementById('teacher-signature-url').value, principalSignatureUrl: document.getElementById('principal-signature-url').value }; try { await setDoc(doc(db, "settings", "schoolDetails"), settingsData, { merge: true }); settingsStatus.textContent = 'Settings saved successfully!'; settingsStatus.style.color = 'green'; } catch (error) { console.error(error); settingsStatus.textContent = 'Error saving settings.'; settingsStatus.style.color = 'red'; } finally { saveSettingsBtn.disabled = false; settingsLoader.classList.add('hidden'); setTimeout(() => { settingsStatus.textContent = ''; }, 3000); } });
    </script>
</body>
</html>

